<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Blog: Preparing for Docker | Apsis Labs | Apsis Labs</title><meta name="description" content="It is a dark winter day at your desk in Maine and your boss gets back from sunny California and says &quot;Docker is the best, we need to start using this for everything!&quot;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to&amp;hellip;"/><link rel="canonical" href="https://www.apsis.io/blog/2017/01/13/preparing-for-docker/"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><meta property="og:url" content="https://www.apsis.io/blog/2017/01/13/preparing-for-docker/"/><meta property="og:type" content="website"/><meta property="og:title" content="Blog: Preparing for Docker | Apsis Labs"/><meta property="og:description" content="It is a dark winter day at your desk in Maine and your boss gets back from sunny California and says &quot;Docker is the best, we need to start using this for everything!&quot;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to&amp;hellip;"/><meta property="og:image" content="https://www.apsis.io/img/posts/shipping-containers.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:domain" content="apsis.io"/><meta property="twitter:url" content="https://www.apsis.io/blog/2017/01/13/preparing-for-docker/"/><meta name="twitter:title" content="Blog: Preparing for Docker | Apsis Labs"/><meta name="twitter:description" content="It is a dark winter day at your desk in Maine and your boss gets back from sunny California and says &quot;Docker is the best, we need to start using this for everything!&quot;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to&amp;hellip;"/><meta name="twitter:image" content="https://www.apsis.io/img/posts/shipping-containers.jpg"/><meta name="next-head-count" content="19"/><link rel="preload" href="/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/37e85b36581a02ab-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/035951aefad7b653-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/a9387c470a117487-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/3478b6abef19b3b3-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/67d66492b0056737.css" as="style"/><link rel="stylesheet" href="/_next/static/css/67d66492b0056737.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2cf3f90a25a8ca11.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2cf3f90a25a8ca11.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-38cee4c0e358b1a3.js" defer=""></script><script src="/_next/static/chunks/framework-64ad27b21261a9ce.js" defer=""></script><script src="/_next/static/chunks/main-58eb4e77e43e295f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a71de3844a248b33.js" defer=""></script><script src="/_next/static/chunks/29107295-b69273ee11039136.js" defer=""></script><script src="/_next/static/chunks/21-a3363dbed0180e50.js" defer=""></script><script src="/_next/static/chunks/406-606c92b76191c4bd.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-a9d3169d936525d7.js" defer=""></script><script src="/_next/static/dd_TcqkLdtYlHG4asepwj/_buildManifest.js" defer=""></script><script src="/_next/static/dd_TcqkLdtYlHG4asepwj/_ssgManifest.js" defer=""></script><style id="__jsx-1589735335">:root{--font-inter:'__Inter_d65c78', '__Inter_Fallback_d65c78';--font-mono:'__IBM_Plex_Mono_191acc', '__IBM_Plex_Mono_Fallback_191acc'}</style></head><body><div id="__next"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#2173aa" class="jsx-1589735335"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2c3e50" class="jsx-1589735335"/><div id="wrapper" class="jsx-1589735335"><section class="Section_section__rDOJq Section_section--bordered__v_Az0"><div class="Section_section__mask__iGDmr"></div><div class="Section_section__container__9Fwqr"><div class="Section_section__content__Klb0i"><nav class="Navbar_navbar__pYr0W"><a class="Navbar_navbar__logo__NNGhf" href="/"><h2 class="LogoType_logotype__iHLMP"><svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="LogoType_logotype__planet__674Ub" width="24" height="24"><path fill-rule="evenodd" clip-rule="evenodd" d="M32 64C49.6731 64 64 49.6731 64 32C64 14.3269 49.6731 0 32 0C14.3269 0 0 14.3269 0 32C0 49.6731 14.3269 64 32 64ZM32 61C48.0163 61 61 48.0163 61 32C61 15.9837 48.0163 3 32 3C15.9837 3 3 15.9837 3 32C3 48.0163 15.9837 61 32 61ZM58 32C58 46.3594 46.3594 58 32 58C17.6406 58 6 46.3594 6 32C6 17.6406 17.6406 6 32 6C46.3594 6 58 17.6406 58 32ZM44 26C47.3137 26 50 23.3137 50 20C50 16.6863 47.3137 14 44 14C40.6863 14 38 16.6863 38 20C38 23.3137 40.6863 26 44 26Z" fill="currentColor"></path></svg><span class="LogoType_logotype__wordmark__0u4jx">Apsis Labs</span></h2></a><nav class="Navbar_navbar__nav__YFZzV"><a class="Navbar_navbar__nav_item__OpfdQ Navbar_navbar__nav_item--hide_mobile__aGOmV" href="/">Home</a><a class="Navbar_navbar__nav_item__OpfdQ" href="/team/">Team</a><a class="Navbar_navbar__nav_item__OpfdQ" href="/mission/">Mission</a><a class="Navbar_navbar__nav_item__OpfdQ" href="/blog/">Blog</a></nav><div class="Navbar_navbar__right__0me1_"><div><a class="Button_button__f48jK Button_button--primary__dDDct" href="mailto:contact@apsis.io?subject=Apsis Project Inquiry">Work with us<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right Button_button__end_icon__4NJ0h"><path d="m9 18 6-6-6-6"></path></svg></a></div></div></nav></div></div></section><main id="main"><section class="Section_section__rDOJq Section_section--spaced__Ihmp2 Section_section--narrow__GIboH"><div class="Section_section__mask__iGDmr"></div><div class="Section_section__container__9Fwqr"><div class="Section_section__content__Klb0i"><div class=""><article class="Post_post__m_Xor" itemType="http://schema.org/BlogPosting"><header class="Post_post__header__pEZ4C"><div class="stack gap-sm"><h1 class="Post_post__title__eUeKR"><a href="/blog/2017/01/13/preparing-for-docker/">Preparing for Docker</a></h1><footer class="Post_post__meta__j55Gy">Posted on<!-- --> <time dateTime="2017-01-1" itemProp="datePublished">2017-01-1</time> <!-- -->by<!-- --> <span itemProp="author" itemscope="" itemType="http://schema.org/Person"><span itemProp="name">Eric Greer, Senior Engineer &amp; Devops Specialist</span></span></footer></div><div class="Post_post__image-wrapper__mjNlP"><img src="/img/posts/shipping-containers.jpg" alt="Preparing for Docker" class="Post_post__image__Dbjks" data-action="zoom"/><small class="Post_post__photo-credit__XuOL7">Image by <!-- -->olafpictures</small></div></header><div class="Post_post__content__SHRW1"><p>It is a dark winter day at your desk in Maine and your boss gets back from sunny California and says &#8220;Docker is the best, we need to start using this for everything!&#8221;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to setup and run Docker and jump right into figuring out how to apply it to your current projects because it needs to be done yesterday.</p>
<p>Before looking into how to setup Docker, let&#8217;s fill in the basics of what you always wanted to know about Docker but didn&#8217;t know you needed to ask.</p>
<h2 id="what-is-docker">What is Docker?</h2>
<p>Docker is a tool for developing applications in a virtualized operating system, called a container, which can run on any hardware, guaranteeing that the software runs the same in any environment.</p>
<p>Docker containers allow you to install anything that would normally be installed on a server to run your application into a portable file that can be moved from environment to environment without any need to reinstall the dependencies.</p>
<p>Docker is similar to Vagrant and VMWare; all three of which allow you to setup virtual infrastructure on top of physical hardware, but each one has its own degree of control. Docker containers operate on the principle that each container runs one process vs running multiple services on one VM.</p>
<p>What about Docker Compose? Docker Compose is tool set provided by Docker for configuring, networking and deploying multiple containers for more complex application configurations.</p>
<h2 id="why-docker">Why Docker?</h2>
<p>There are many reasons for choosing Docker:</p>
<ul>
<li>Ease of Creation - Image is defined in one file, with simple run commands</li>
<li>Speed - Much faster than a full VM for startup ( after the initial download )</li>
<li>Size - Although the images can inflate really quickly they are generally smaller than full VMs</li>
<li>Consistency - The image used locally can be the same as production</li>
<li>Reproducibility - Container configuration is a file which can be stored in version control</li>
</ul>
<p>Docker is very well designed for local development as it focuses on running one application in its own environment. This helps separate processes from different applications without having to setup multiple VMs.</p>
<p>For all the various projects you may interact with, most likely there is a Docker image already preconfigured with the basic software for running your particular language ( Rails, Python, etc ) or software ( Nginx, Memcached, MySQL, etc. ) Just take a look on Docker Hub and look for the official tag for any library.</p>
<h2 id="production-concerns">Production Concerns</h2>
<p>As you think about moving your Docker application into production there becomes a whole host of challenges and problems you will need to solve.</p>
<ul>
<li>Container Hosting - Hosted vs cloud repositories like Docker Hub or Quay.io</li>
<li>Deployment Strategies - Tools like Rancher or Kubernetes</li>
<li>Garbage Collection - Old images fill up disk on the host</li>
<li>Database Management - Don&#8217;t run in a container!</li>
<li>Logging - Shared mounted volume to write log to disk vs external logging service</li>
<li>Monitoring - Performance, uptime, resource utilization, etc.</li>
</ul>
<p>Cloud 66 has a great article detailing these items before using Docker in production: <a href="http://blog.cloud66.com/9-crtitical-decisions-needed-to-run-docker-in-production/">http://blog.cloud66.com/9-crtitical-decisions-needed-to-run-docker-in-production/</a></p>
<h2 id="tips-and-tricks">Tips and Tricks</h2>
<h3 id="planning-the-architecture">Planning the Architecture</h3>
<p>Deciding whether Nginx in front of the Rails application or Memcached in front of the DB is the right choice for the system will help determine how to setup a Docker network. Docker Compose allows setup for networking between multiple containers, any external dependencies, volumes, and environmental variables the containers may need.</p>
<h3 id="image-size">Image Size</h3>
<p>Docker containers can grow in size very quickly, and minimizing the size helps portability. Every command run in the DockerFile creates its own container as a snapshot which helps reuse across Docker builds but increases the size significantly. To minimize the container, start by finding the minimal image that will support the software and only install the minimal software needed. The next step is to condense all the run commands into the fewest number needed.</p>
<p>For example when installing dependencies a typical install might look like:</p>
<pre><code>RUN apt-get update -qq &amp;&amp; apt-get install -y build-essential
RUN apt-get update -qq &amp;&amp; apt-get install -y nodejs
RUN apt-get update -qq &amp;&amp; apt-get install -y python2.7
</code></pre><p>This creates three containers. A more optimized version that only creates one container is:</p>
<pre><code>RUN apt-get update -qq &amp;&amp; apt-get install -y \
    build-essential \
    nodejs \
    python2.7
</code></pre><p>Codeship has a great article detailing some of the optimizations for the Dockerfile: <a href="https://blog.codeship.com/reduce-docker-image-size/">https://blog.codeship.com/reduce-docker-image-size/</a></p>
<h3 id="cleanup">Cleanup</h3>
<p>Monitoring the host&#8217;s disk space where Docker containers are deployed is crucial, especially in development environments where several versions of a Docker container may be pushed a day. The easy way to clean up is to setup a cron to run:</p>
<pre><code>sudo docker images -q | xargs sudo docker rmi
</code></pre><p>Or you can run a full container to manage garbage collection for you: <a href="https://github.com/spotify/docker-gc">https://github.com/spotify/docker-gc</a></p>
<h2 id="wrap-up">Wrap up</h2>
<p>Docker is a great technology for development environments and simpler applications, but consider carefully whether it is a good fit for your particular application&#8217;s needs, especially if there is already a technology stack in place.</p>
<p>Here at Apsis we use the technology that is right for the application and are constantly looking out for changes in best practices and supporting technologies, so I&#8217;m sure you&#8217;ll hear more about our exploration with Docker in future posts.</p>
<p><em>&#8220;Wait, what do you mean we aren&#8217;t going to use Docker anymore? I just got everything converted&#8230; Noaaahhh!!!&#8221;</em></p>
<h2 id="resources">Resources</h2>
<p>For everything you can do with Docker and Docker Compose it is good to check out the docs.</p>
<p><a href="https://docs.docker.com">https://docs.docker.com</a></p>
<p>For help finding the perfect image, Docker Hub has your back.</p>
<p><a href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<p>For index of everything Docker checkout Awesome Docker:</p>
<p><a href="https://veggiemonk.github.io/awesome-docker/">https://veggiemonk.github.io/awesome-docker/</a></p>
</div><div class="stack"><hr class="divider"/><aside class="TeamMember_bio__Y5I_b TeamMember_bio--small__yU2KA"><img src="/img/people/eric.jpg" alt="Avatar" width="60" height="60" class="TeamMember_bio__image__JrzJn"/><div class="TeamMember_bio__content__x_RYN"><header class="TeamMember_bio__header__i2syF"><h2 class="TeamMember_bio__title__GN4dr">Eric Greer</h2><h3 class="TeamMember_bio__subtitle__tNr_z">Senior Engineer &amp; Devops Specialist</h3></header><ul class="TeamMember_bio__social___oEgL"><li class="TeamMember_bio__social_link__oIAzy"><a title="Eric Greer on blog" href="/blog/people/eric/"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 24 24"><title>Eric Greer on blog</title><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"></path></svg></a></li><li class="TeamMember_bio__social_link__oIAzy"><a target="_blank" title="Eric Greer on github" href="https://github.com/egreer"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 24 24"><title>Eric Greer on github</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></li><li class="TeamMember_bio__social_link__oIAzy"><a target="_blank" title="Eric Greer on linkedin" href="https://www.linkedin.com/in/greereric/"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 24 24"><title>Eric Greer on linkedin</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></li></ul><div class="typography"><div><p>A full-stack developer with 15 years of experience and a passion for DevOps
 Eric has helped numerous clients navigate the cloud with AWS. Always eager for the next challenge,
 he loves learning each business&#8217;s nuances and delivering stability
 through automation.</p>
</div></div><a href="/blog/people/eric/">Read more by <!-- -->Eric Greer</a></div></aside></div></article></div></div></div></section></main><section class="Section_section__rDOJq Section_section--blue__qmXZ5 Section_section--bordered__v_Az0"><div class="Section_section__mask__iGDmr"><div class="Section_section__guides__rCsOH"></div></div><div class="Section_section__container__9Fwqr"><div class="Section_section__content__Klb0i"><div class="Cta_cta__7YtmN"><header class="Cta_cta__header__6cQ_o"><div class="Cta_cta__title__XXFrR"><p>What do you want to build?</p>
</div><div class="Cta_cta__subtitle__yCW8x"><p>We&#8217;d love to help. Let&#8217;s find out how.</p>
</div></header><div><a class="Button_button__f48jK Button_button--primary__dDDct Button_button--lg___ILEI" href="mailto:contact@apsis.io?subject=Apsis Project Inquiry">Work with us<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right Button_button__end_icon__4NJ0h"><path d="m9 18 6-6-6-6"></path></svg></a></div></div></div></div></section><section class="Section_section__rDOJq Section_section--gray__Xj11z"><div class="Section_section__mask__iGDmr"><div class="Section_section__guides__rCsOH"></div></div><div class="Section_section__container__9Fwqr"><div class="Section_section__content__Klb0i"><footer class="Footer_footer__W37AO"><div class="Row_row__1wkRY Row_row--top__qt9xi"><div class="stack gap-md"><a class="Footer_footer__logo__G9sAT" href="/"><h2 class="LogoType_logotype__iHLMP Footer_footer__logotype__Olnhi"><svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="LogoType_logotype__planet__674Ub" width="24" height="24"><path fill-rule="evenodd" clip-rule="evenodd" d="M32 64C49.6731 64 64 49.6731 64 32C64 14.3269 49.6731 0 32 0C14.3269 0 0 14.3269 0 32C0 49.6731 14.3269 64 32 64ZM32 61C48.0163 61 61 48.0163 61 32C61 15.9837 48.0163 3 32 3C15.9837 3 3 15.9837 3 32C3 48.0163 15.9837 61 32 61ZM58 32C58 46.3594 46.3594 58 32 58C17.6406 58 6 46.3594 6 32C6 17.6406 17.6406 6 32 6C46.3594 6 58 17.6406 58 32ZM44 26C47.3137 26 50 23.3137 50 20C50 16.6863 47.3137 14 44 14C40.6863 14 38 16.6863 38 20C38 23.3137 40.6863 26 44 26Z" fill="currentColor"></path></svg><span class="LogoType_logotype__wordmark__0u4jx">Apsis Labs</span></h2></a><small><ul role="list" class="Footer_footer__nav__HD7uG"><li>Copyright <!-- -->2025<!-- --> Apsis Labs, LLP</li><li><a class="link" target="_blank" href="https://github.com/apsislabs">Github</a></li><li><a class="link" target="_blank" href="https://www.linkedin.com/company/apsislabs/">LinkedIn</a></li><li><a class="link" href="mailto:contact@apsis.io">contact@apsis.io</a></li></ul></small><small><ul role="list" class="Footer_footer__nav__HD7uG"><li><a class="link" href="/privacy/">Privacy Policy</a></li><li><a class="link" href="/conduct/">Code of Conduct</a></li><li><a class="link" href="/mdbn/">Data Breach Notification Policy</a></li></ul></small></div><div class="Footer_footer__tagline_container__19nxT"><h4 class="Footer_footer__tagline__gO_GO">Distributed &amp; Horizontally Scalable</h4><small><ul class="inline_list"><li>Seattle <span class="text-muted">→</span></li><li>Boulder <span class="text-muted">→</span></li><li>Boston <span class="text-muted">→</span></li><li>Portland <span class="text-muted">→</span></li><li>Hartford</li></ul></small></div></div></footer></div></div></section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"preparing-for-docker","href":{"pathname":"/blog/[year]/[month]/[day]/[slug]","query":{"year":"2017","month":"01","day":"13","slug":"preparing-for-docker"}},"person":{"name":"Eric Greer","current":true,"title":"Senior Engineer \u0026 Devops Specialist","image":"/img/people/eric.jpg","bio":"Eric is a full stack software developer with a passion for DevOps. Working\nwith the nuances of AWS, he has worked move large clients and small into the\ncloud architecture that is right for them, automating deployments and\nensuring applications stability. Eric has a B.S and M.S. in Computer Science\nfrom WPI, a background in IT support, combined with 15 years of software\ndevelopment projects which gives him an attention to detail and makes him a\ngo to resource for any questions a client may have. Eric finds passion\nlearning the nuances of each business and is always excited to tackle the\nnext challenging project.\n","bio_short":"A full-stack developer with 15 years of experience and a passion for DevOps\n Eric has helped numerous clients navigate the cloud with AWS. Always eager for the next challenge,\n he loves learning each business's nuances and delivering stability\n through automation.\n","social":[{"network":"linkedin","link":"https://www.linkedin.com/in/greereric/"},{"network":"blog","link":"/blog/people/eric"},{"network":"github","link":"https://github.com/egreer"}]},"desc":"It is a dark winter day at your desk in Maine and your boss gets back from sunny California and says \"Docker is the best, we need to start using this for everything!\". You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to\u0026hellip;","contentHtml":"\u003cp\u003eIt is a dark winter day at your desk in Maine and your boss gets back from sunny California and says \u0026#8220;Docker is the best, we need to start using this for everything!\u0026#8221;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to setup and run Docker and jump right into figuring out how to apply it to your current projects because it needs to be done yesterday.\u003c/p\u003e\n\u003cp\u003eBefore looking into how to setup Docker, let\u0026#8217;s fill in the basics of what you always wanted to know about Docker but didn\u0026#8217;t know you needed to ask.\u003c/p\u003e\n\u003ch2 id=\"what-is-docker\"\u003eWhat is Docker?\u003c/h2\u003e\n\u003cp\u003eDocker is a tool for developing applications in a virtualized operating system, called a container, which can run on any hardware, guaranteeing that the software runs the same in any environment.\u003c/p\u003e\n\u003cp\u003eDocker containers allow you to install anything that would normally be installed on a server to run your application into a portable file that can be moved from environment to environment without any need to reinstall the dependencies.\u003c/p\u003e\n\u003cp\u003eDocker is similar to Vagrant and VMWare; all three of which allow you to setup virtual infrastructure on top of physical hardware, but each one has its own degree of control. Docker containers operate on the principle that each container runs one process vs running multiple services on one VM.\u003c/p\u003e\n\u003cp\u003eWhat about Docker Compose? Docker Compose is tool set provided by Docker for configuring, networking and deploying multiple containers for more complex application configurations.\u003c/p\u003e\n\u003ch2 id=\"why-docker\"\u003eWhy Docker?\u003c/h2\u003e\n\u003cp\u003eThere are many reasons for choosing Docker:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEase of Creation - Image is defined in one file, with simple run commands\u003c/li\u003e\n\u003cli\u003eSpeed - Much faster than a full VM for startup ( after the initial download )\u003c/li\u003e\n\u003cli\u003eSize - Although the images can inflate really quickly they are generally smaller than full VMs\u003c/li\u003e\n\u003cli\u003eConsistency - The image used locally can be the same as production\u003c/li\u003e\n\u003cli\u003eReproducibility - Container configuration is a file which can be stored in version control\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDocker is very well designed for local development as it focuses on running one application in its own environment. This helps separate processes from different applications without having to setup multiple VMs.\u003c/p\u003e\n\u003cp\u003eFor all the various projects you may interact with, most likely there is a Docker image already preconfigured with the basic software for running your particular language ( Rails, Python, etc ) or software ( Nginx, Memcached, MySQL, etc. ) Just take a look on Docker Hub and look for the official tag for any library.\u003c/p\u003e\n\u003ch2 id=\"production-concerns\"\u003eProduction Concerns\u003c/h2\u003e\n\u003cp\u003eAs you think about moving your Docker application into production there becomes a whole host of challenges and problems you will need to solve.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eContainer Hosting - Hosted vs cloud repositories like Docker Hub or Quay.io\u003c/li\u003e\n\u003cli\u003eDeployment Strategies - Tools like Rancher or Kubernetes\u003c/li\u003e\n\u003cli\u003eGarbage Collection - Old images fill up disk on the host\u003c/li\u003e\n\u003cli\u003eDatabase Management - Don\u0026#8217;t run in a container!\u003c/li\u003e\n\u003cli\u003eLogging - Shared mounted volume to write log to disk vs external logging service\u003c/li\u003e\n\u003cli\u003eMonitoring - Performance, uptime, resource utilization, etc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCloud 66 has a great article detailing these items before using Docker in production: \u003ca href=\"http://blog.cloud66.com/9-crtitical-decisions-needed-to-run-docker-in-production/\"\u003ehttp://blog.cloud66.com/9-crtitical-decisions-needed-to-run-docker-in-production/\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"tips-and-tricks\"\u003eTips and Tricks\u003c/h2\u003e\n\u003ch3 id=\"planning-the-architecture\"\u003ePlanning the Architecture\u003c/h3\u003e\n\u003cp\u003eDeciding whether Nginx in front of the Rails application or Memcached in front of the DB is the right choice for the system will help determine how to setup a Docker network. Docker Compose allows setup for networking between multiple containers, any external dependencies, volumes, and environmental variables the containers may need.\u003c/p\u003e\n\u003ch3 id=\"image-size\"\u003eImage Size\u003c/h3\u003e\n\u003cp\u003eDocker containers can grow in size very quickly, and minimizing the size helps portability. Every command run in the DockerFile creates its own container as a snapshot which helps reuse across Docker builds but increases the size significantly. To minimize the container, start by finding the minimal image that will support the software and only install the minimal software needed. The next step is to condense all the run commands into the fewest number needed.\u003c/p\u003e\n\u003cp\u003eFor example when installing dependencies a typical install might look like:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eRUN apt-get update -qq \u0026amp;\u0026amp; apt-get install -y build-essential\nRUN apt-get update -qq \u0026amp;\u0026amp; apt-get install -y nodejs\nRUN apt-get update -qq \u0026amp;\u0026amp; apt-get install -y python2.7\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis creates three containers. A more optimized version that only creates one container is:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eRUN apt-get update -qq \u0026amp;\u0026amp; apt-get install -y \\\n    build-essential \\\n    nodejs \\\n    python2.7\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eCodeship has a great article detailing some of the optimizations for the Dockerfile: \u003ca href=\"https://blog.codeship.com/reduce-docker-image-size/\"\u003ehttps://blog.codeship.com/reduce-docker-image-size/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"cleanup\"\u003eCleanup\u003c/h3\u003e\n\u003cp\u003eMonitoring the host\u0026#8217;s disk space where Docker containers are deployed is crucial, especially in development environments where several versions of a Docker container may be pushed a day. The easy way to clean up is to setup a cron to run:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esudo docker images -q | xargs sudo docker rmi\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOr you can run a full container to manage garbage collection for you: \u003ca href=\"https://github.com/spotify/docker-gc\"\u003ehttps://github.com/spotify/docker-gc\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"wrap-up\"\u003eWrap up\u003c/h2\u003e\n\u003cp\u003eDocker is a great technology for development environments and simpler applications, but consider carefully whether it is a good fit for your particular application\u0026#8217;s needs, especially if there is already a technology stack in place.\u003c/p\u003e\n\u003cp\u003eHere at Apsis we use the technology that is right for the application and are constantly looking out for changes in best practices and supporting technologies, so I\u0026#8217;m sure you\u0026#8217;ll hear more about our exploration with Docker in future posts.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u0026#8220;Wait, what do you mean we aren\u0026#8217;t going to use Docker anymore? I just got everything converted\u0026#8230; Noaaahhh!!!\u0026#8221;\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"resources\"\u003eResources\u003c/h2\u003e\n\u003cp\u003eFor everything you can do with Docker and Docker Compose it is good to check out the docs.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com\"\u003ehttps://docs.docker.com\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFor help finding the perfect image, Docker Hub has your back.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://hub.docker.com/\"\u003ehttps://hub.docker.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFor index of everything Docker checkout Awesome Docker:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://veggiemonk.github.io/awesome-docker/\"\u003ehttps://veggiemonk.github.io/awesome-docker/\u003c/a\u003e\u003c/p\u003e\n","author":"eric","layout":"post","title":"Preparing for Docker","image":"/img/posts/shipping-containers.jpg","credit":"olafpictures","date":"2017-01-1","excerpt":"\u003cp\u003eIt is a dark winter day at your desk in Maine and your boss gets back from sunny California and says \u0026#8220;Docker is the best, we need to start using this for everything!\u0026#8221;. You internally groan because you just got all the infrastructure working correctly, but you start frantically searching how to\u0026hellip;\u003c/p\u003e\n"},"cta":{"title":"What do you want to build?","subtitle":"We'd love to help. Let's find out how.","button":"Work with us"}},"__N_SSG":true},"page":"/blog/[year]/[month]/[day]/[slug]","query":{"year":"2017","month":"01","day":"13","slug":"preparing-for-docker"},"buildId":"dd_TcqkLdtYlHG4asepwj","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>